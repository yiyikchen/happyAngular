{"version":3,"file":"delon-util-decorator.js","sources":["../../../../packages/util/decorator/convert.ts","../../../../packages/util/decorator/zone-outside.ts","../../../../packages/util/decorator/delon-util-decorator.ts"],"names":[],"mappings":"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","sourcesContent":["import { warn } from '@delon/util/other';\nimport type { NzSafeAny } from 'ng-zorro-antd/core/types';\n\nexport type BooleanInput = boolean | string | undefined | null;\nexport type NumberInput = number | string | undefined | null;\n\nfunction propDecoratorFactory<T, D>(\n  name: string,\n  fallback: (v: T, defaultValue: D) => D,\n  defaultValue: NzSafeAny\n): (target: NzSafeAny, propName: string) => void {\n  function propDecorator(\n    target: NzSafeAny,\n    propName: string,\n    originalDescriptor?: TypedPropertyDescriptor<NzSafeAny>\n  ): NzSafeAny {\n    const privatePropName = `$$__${propName}`;\n\n    if (Object.prototype.hasOwnProperty.call(target, privatePropName)) {\n      warn(`The prop \"${privatePropName}\" is already exist, it will be overrided by ${name} decorator.`);\n    }\n\n    Object.defineProperty(target, privatePropName, {\n      configurable: true,\n      writable: true\n    });\n\n    return {\n      get(): string {\n        return originalDescriptor && originalDescriptor.get\n          ? originalDescriptor.get.bind(this)()\n          : this[privatePropName];\n      },\n      set(value: T): void {\n        if (originalDescriptor && originalDescriptor.set) {\n          originalDescriptor.set.bind(this)(fallback(value, defaultValue));\n        }\n        this[privatePropName] = fallback(value, defaultValue);\n      }\n    };\n  }\n\n  return propDecorator;\n}\n\nexport function toBoolean(\n  value: unknown,\n  defaultValue: boolean | null | undefined = false\n): boolean | null | undefined {\n  return value == null ? defaultValue : `${value}` !== 'false';\n}\n\n/**\n * Input decorator that handle a prop to do get/set automatically with toBoolean\n *\n * ```ts\n * {AT}Input() {AT}InputBoolean() visible: boolean = false;\n * {AT}Input() {AT}InputBoolean(null) visible: boolean = false;\n * ```\n */\nexport function InputBoolean(defaultValue: boolean | null = false): NzSafeAny {\n  return propDecoratorFactory('InputBoolean', toBoolean, defaultValue);\n}\n\nexport function toNumber(value: unknown): number;\nexport function toNumber<D>(value: unknown, fallback: D): number | D;\nexport function toNumber(value: unknown, fallbackValue: number = 0): number {\n  return !isNaN(parseFloat(value as NzSafeAny)) && !isNaN(Number(value)) ? Number(value) : fallbackValue;\n}\n\n/**\n * Input decorator that handle a prop to do get/set automatically with toNumber\n *\n * ```ts\n * {AT}Input() {AT}InputNumber() visible: number = 1;\n * {AT}Input() {AT}InputNumber(null) visible: number = 2;\n * ```\n */\nexport function InputNumber(defaultValue: number | null = 0): NzSafeAny {\n  return propDecoratorFactory('InputNumber', toNumber, defaultValue);\n}\n","import { warn } from '@delon/util/other';\nimport type { NzSafeAny } from 'ng-zorro-antd/core/types';\n\nexport interface ZoneOptions {\n  ngZoneName?: string;\n}\n\ntype DecoratorType = (target: unknown, fn: string, descriptor: PropertyDescriptor) => PropertyDescriptor;\n\nfunction makeFn(type: 'runOutsideAngular' | 'run', options?: ZoneOptions): DecoratorType {\n  return (_, __, descriptor) => {\n    const source = descriptor.value;\n    descriptor.value = function (...data: NzSafeAny[]): () => void {\n      const that = this as NzSafeAny;\n      const ngZone = that[options?.ngZoneName || 'ngZone'];\n      if (!ngZone) {\n        warn(`ZoneOutside: Decorator should have 'ngZone' property with 'NgZone' class.`);\n        return source.call(this, ...data);\n      }\n      let res: NzSafeAny;\n      ngZone[type](() => {\n        res = source.call(this, ...data);\n      });\n      return res;\n    };\n\n    return descriptor;\n  };\n}\n\n/**\n * The decoration method runs in `runOutsideAngular`\n *\n * 装饰方法运行在 `runOutsideAngular` 内\n *\n * ```ts\n * class MockClass {\n *  constructor(public ngZone: NgZone) {}\n *\n *  {AT}ZoneOutside()\n *  runOutsideAngular(): void {}\n * }\n * ```\n */\nexport function ZoneOutside(options?: ZoneOptions): DecoratorType {\n  return makeFn('runOutsideAngular', options);\n}\n\n/**\n * The decoration method runs in `run`\n *\n * 装饰方法运行在 `run` 内\n *\n * ```ts\n * class MockClass {\n *  constructor(public ngZone: NgZone) {}\n *\n *  {AT}ZoneRun()\n *  run(): void {}\n * }\n * ```\n */\nexport function ZoneRun(options?: ZoneOptions): DecoratorType {\n  return makeFn('run', options);\n}\n","/**\n * Generated bundle index. Do not edit.\n */\n\nexport * from './index';\n"]}