import { DOCUMENT } from '@angular/common';
import { inject, InjectionToken } from '@angular/core';
import { fromEvent } from 'rxjs';
import { distinctUntilChanged, map, share, startWith } from 'rxjs/operators';
/**
 * Use the `visibilitychange` event to monitor whether the browser tab is visible, which is generally used when the user leaves the browser tab to temp interrupt the backend to continue sending requests
 *
 * 通过 `visibilitychange` 事件来监听浏览器选项卡是否可见，一般用于当用户离开应用时暂时中断后端持续发送请求时
 */
export const PAGE_VISIBILITY = new InjectionToken('PAGE_VISIBILITY`', {
    factory: () => {
        const doc = inject(DOCUMENT);
        return fromEvent(doc, 'visibilitychange').pipe(startWith(0), map(() => !doc.hidden), distinctUntilChanged(), share());
    }
});
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoicGFnZS12aXNpYmlsaXR5LmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsiLi4vLi4vLi4vLi4vLi4vcGFja2FnZXMvdXRpbC90b2tlbi9wYWdlLXZpc2liaWxpdHkudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUEsT0FBTyxFQUFFLFFBQVEsRUFBRSxNQUFNLGlCQUFpQixDQUFDO0FBQzNDLE9BQU8sRUFBRSxNQUFNLEVBQUUsY0FBYyxFQUFFLE1BQU0sZUFBZSxDQUFDO0FBQ3ZELE9BQU8sRUFBRSxTQUFTLEVBQWMsTUFBTSxNQUFNLENBQUM7QUFDN0MsT0FBTyxFQUFFLG9CQUFvQixFQUFFLEdBQUcsRUFBRSxLQUFLLEVBQUUsU0FBUyxFQUFFLE1BQU0sZ0JBQWdCLENBQUM7QUFFN0U7Ozs7R0FJRztBQUNILE1BQU0sQ0FBQyxNQUFNLGVBQWUsR0FBRyxJQUFJLGNBQWMsQ0FBc0Isa0JBQWtCLEVBQUU7SUFDekYsT0FBTyxFQUFFLEdBQUcsRUFBRTtRQUNaLE1BQU0sR0FBRyxHQUFHLE1BQU0sQ0FBQyxRQUFRLENBQUMsQ0FBQztRQUM3QixPQUFPLFNBQVMsQ0FBQyxHQUFHLEVBQUUsa0JBQWtCLENBQUMsQ0FBQyxJQUFJLENBQzVDLFNBQVMsQ0FBQyxDQUFDLENBQUMsRUFDWixHQUFHLENBQUMsR0FBRyxFQUFFLENBQUMsQ0FBQyxHQUFHLENBQUMsTUFBTSxDQUFDLEVBQ3RCLG9CQUFvQixFQUFFLEVBQ3RCLEtBQUssRUFBRSxDQUNSLENBQUM7SUFDSixDQUFDO0NBQ0YsQ0FBQyxDQUFDIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgRE9DVU1FTlQgfSBmcm9tICdAYW5ndWxhci9jb21tb24nO1xuaW1wb3J0IHsgaW5qZWN0LCBJbmplY3Rpb25Ub2tlbiB9IGZyb20gJ0Bhbmd1bGFyL2NvcmUnO1xuaW1wb3J0IHsgZnJvbUV2ZW50LCBPYnNlcnZhYmxlIH0gZnJvbSAncnhqcyc7XG5pbXBvcnQgeyBkaXN0aW5jdFVudGlsQ2hhbmdlZCwgbWFwLCBzaGFyZSwgc3RhcnRXaXRoIH0gZnJvbSAncnhqcy9vcGVyYXRvcnMnO1xuXG4vKipcbiAqIFVzZSB0aGUgYHZpc2liaWxpdHljaGFuZ2VgIGV2ZW50IHRvIG1vbml0b3Igd2hldGhlciB0aGUgYnJvd3NlciB0YWIgaXMgdmlzaWJsZSwgd2hpY2ggaXMgZ2VuZXJhbGx5IHVzZWQgd2hlbiB0aGUgdXNlciBsZWF2ZXMgdGhlIGJyb3dzZXIgdGFiIHRvIHRlbXAgaW50ZXJydXB0IHRoZSBiYWNrZW5kIHRvIGNvbnRpbnVlIHNlbmRpbmcgcmVxdWVzdHNcbiAqXG4gKiDpgJrov4cgYHZpc2liaWxpdHljaGFuZ2VgIOS6i+S7tuadpeebkeWQrOa1j+iniOWZqOmAiemhueWNoeaYr+WQpuWPr+inge+8jOS4gOiIrOeUqOS6juW9k+eUqOaIt+emu+W8gOW6lOeUqOaXtuaaguaXtuS4reaWreWQjuerr+aMgee7reWPkemAgeivt+axguaXtlxuICovXG5leHBvcnQgY29uc3QgUEFHRV9WSVNJQklMSVRZID0gbmV3IEluamVjdGlvblRva2VuPE9ic2VydmFibGU8Ym9vbGVhbj4+KCdQQUdFX1ZJU0lCSUxJVFlgJywge1xuICBmYWN0b3J5OiAoKSA9PiB7XG4gICAgY29uc3QgZG9jID0gaW5qZWN0KERPQ1VNRU5UKTtcbiAgICByZXR1cm4gZnJvbUV2ZW50KGRvYywgJ3Zpc2liaWxpdHljaGFuZ2UnKS5waXBlKFxuICAgICAgc3RhcnRXaXRoKDApLFxuICAgICAgbWFwKCgpID0+ICFkb2MuaGlkZGVuKSxcbiAgICAgIGRpc3RpbmN0VW50aWxDaGFuZ2VkKCksXG4gICAgICBzaGFyZSgpXG4gICAgKTtcbiAgfVxufSk7XG4iXX0=